"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.createSubscriptionsStore = undefined;

var _map = require("babel-runtime/core-js/map");

var _map2 = _interopRequireDefault(_map);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var createSubscriptionsStore = exports.createSubscriptionsStore = function createSubscriptionsStore() {
  var subscripions = new _map2.default();

  return {
    register: function register(subscribe) {
      var subscription = subscripions.get(subscribe);
      if (!subscription) {
        subscription = {
          unsubscribe: subscribe()
        };
        subscripions.set(subscribe, subscription);
      }
      subscription.used = true;
    },
    markAllAsUnused: function markAllAsUnused() {
      subscripions.forEach(function (subscription) {
        // eslint-disable-next-line no-param-reassign
        subscription.used = false;
      });
    },
    clearUnused: function clearUnused() {
      subscripions.forEach(function (subscripion, key) {
        if (subscripion.used) return;

        subscripion.unsubscribe();
        subscripions.delete(key);
      });
    }
  };
};

exports.default = createSubscriptionsStore();